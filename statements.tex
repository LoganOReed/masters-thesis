% If you want to see what things look like for a handout, remove the
% comment from the next line.
\newif\ifHandout%\Handouttrue

\documentclass{book}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Adjust margins and page layout.
\addtolength{\topmargin}{-.5in}
\addtolength{\headsep}{.5in}

\oddsidemargin=.5in
\evensidemargin=.5in
\textwidth=5.5in

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Load a bunch of packages that extend the basic capabilities of LaTeX
\usepackage{
amsmath,% AMS basic math stuff
amsthm,% AMS theorem defining stuff
amsfonts,% defines the blackboard bold fonts for \Z, \R, etc
longtable,% used to create the tcproof environment below
verbatim,% allows for verbatim output, and also covering up stuff in comments
xspace,% adds an extra space an the end of some commands
multicol,% allows multicolumn output
tikz,% creates the tikzpicture drawing environment
charter,% changes the default font to charter
framed,% used to color in the TIscreen environment below
cool,
}

% the next package defines dingbat fonts.  I use dingbat 212 to make a
% thick arrow somewhat like the "to" arrow that's displayed in TI-83
% programming.  
\usepackage{pifont}

% Makes section headings and cross references act like links
\usepackage[colorlinks,unicode]{hyperref}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Create simple shortcut commands.  Almost everyone who uses LaTeX
% creates commands like thes.
\newcommand{\R}{\mathbb{R}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\N}{\mathbb{N}}

% For some reason basic TeX/LaTeX doesn't define a an lcm command!  So
% I create one
\DeclareMathOperator{\lcm}{lcm}

% \cl stands for "class"
\newcommand{\cl}[1]{[#1]}

% \st stands for "such that", used in set builder notation like so
% \{x \st x^2 = 4\}
\newcommand{\st}{\mid}

% Make an equals sign with a question mark over it
\newcommand{\eq}{\stackrel{?}{=}}

% The next line difines a divides sign with a question mark
\newcommand{\divq}{\stackrel{?}{|}}

\newcommand{\forwards}{\mbox{``$\Longrightarrow$''}\xspace}
\newcommand{\backwards}{\mbox{``$\Longleftarrow$''}\xspace}

% this is to highlight words that are being defined and enter.
\newcommand{\define}[1]{\textbf{#1}}

% The names of congruence classes modulo three as I've named them
% (threeven, throd, throve) and as Caytie named them.  This way I can
% change the notes/examples whenever I teach this subject to use the
% names students come up with.  
\newcommand{\threeven}{pretty\xspace}
\newcommand{\throd}{normal\xspace}
\newcommand{\throve}{ugly\xspace}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Create some slightly more sophisticated custom commands.  New
% symbols, or tweaking old ones.  

% The next two lines define a reasonable looking not divides sign.
\DeclareMathSymbol{\nmid}{\mathrel}{AMSb}{"2D}
\newcommand{\notdiv}{\nmid}

% Make the tilde command wider
\renewcommand{\tilde}{\widetilde}

% the following two commands change the way the footnote symbol is
% made to be old fashioned: *, dagger, etc.  
\renewcommand{\thefootnote}{\fnsymbol{footnote}}

% This is how I create marks in the text showing where we finished on
% a given day.  
\def\endclass#1{\par\noindent\hrulefill\fbox{\tiny This is where we
    ended on #1}\hrulefill\vskip 5pt plus 1pt\par }



% Redefine the emptyset symbol so it looks nicer
\DeclareMathSymbol{\varnothing}{\mathord}{AMSb}{"3F}
\renewcommand{\emptyset}{\varnothing}


% If I'm making handouts I (1) sometimes insert a pagebreak so the
% Example starts at the top of the page, and (2) cover up the
% solutions (turn them white!)
\ifHandout
  \newcommand{\handoutpagebreak}{\newpage}
  \newenvironment{solution}
    {\smallskip\par\noindent\emph{Solution: }\color{white}}
    {}
\else
  \newcommand{\handoutpagebreak}{}
  \newenvironment{solution}
  {\smallskip\par\noindent\emph{Solution: }}
  {}
\fi


% The next few commands are for simulating the output of a TI screen.  
\colorlet{shadecolor}{gray!35}
\newenvironment{TIscreen} 
{\begin{center}\tt
\renewcommand{\in}[1]{##1\\}
\newcommand{\out}[1]{\mbox{}\hfill##1\\}
\begin{minipage}{2in}\begin{snugshade}}
{\end{snugshade}\end{minipage}\end{center}}


% The next environment is for creating two column proofs.  
\newenvironment{tcproof}[1]
{\smallskip\par\begin{longtable}{@{}p{.45\textwidth}p{.45\textwidth}@{}}
\multicolumn{2}{@{}l}{\emph{#1}}\\[\smallskipamount]
Assertion & Justification \endfirsthead
Assertion & Justification \endhead
\hline }
{\end{longtable}\qed\smallskip\par}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% The next page or two of stuff is devoted to creating and
% manipulating the environments for lemma, proof, example, etc.
% The first part is pretty simple, and almost everyone has commands
% like this in every paper, article, book, etc.  
% 
% We start with things like lemmas, theorems, etc.
\newtheorem{lemma}{Lemma}[section]
\newtheorem{theorem}[lemma]{Theorem}
\newtheorem{cor}[lemma]{Corollary}
\newtheorem*{scholium}{Scholium}

% Now we create things like definitions, examples, comments, etc.  
\theoremstyle{definition}
\newtheorem{definition}[lemma]{Definition}
\newtheorem{example}[lemma]{Example}
\newenvironment{comments}{}{}

% Now I add a horizontal line at the end of definitions, examples,
% etc.  Note: in theory the ntheorem package should make this easy,
% but the last time I tried it (2010) the  package didn't always work.
\newcommand{\myrule}{\nobreak\par\noindent\mbox{}\hspace*{.333333\textwidth}%
            \rule{.333333\textwidth}{.01in}\hspace*{.33333\textwidth}\par}
\makeatletter
  \g@addto@macro\enddefinition\myrule
  \g@addto@macro\endexample\myrule
  \g@addto@macro\endcomments\myrule
\makeatother


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% The stuff that follows is a bit tricky, and is well more than most
% people do with LaTeX.  The basic idea is that I want to be able to
% show only examples, or only definitions, or hide only proofs, etc.  


\makeatletter
% the following key values give the set up for hiding certain
% environemnts. Note that "true" is just a dummy value.  It would work
% equally well with "foo".  Each one of these redefines the outer
% environment for an atom to turn the whole thing into a hidden
% comment.  Note that the environments theorem, example, etc. do not
% have to be written in any special way for hide and show to work.
% They get clobbered by hide.  
  \define@key{hide}{scholium}[true]{\renewenvironment{scholium}{\comment}{\endcomment}}
  \define@key{hide}{proof}[true]{\renewenvironment{proof}{\comment}{\endcomment}}
  \define@key{hide}{lemma}[true]{\renewenvironment{lemma}{\comment}{\endcomment}}
  \define@key{hide}{comments}[true]{\renewenvironment{comments}{\comment}{\endcomment}}
  \define@key{hide}{cor}[true]{\renewenvironment{cor}{\comment}{\endcomment}}
  \define@key{hide}{definition}[true]{\renewenvironment{definition}{\comment}{\endcomment}}
  \define@key{hide}{example}[true]{\renewenvironment{example}{\comment}{\endcomment}}
  \define@key{hide}{theorem}[true]{\renewenvironment{theorem}{\comment}{\endcomment}}
% Now this command can be given a comma separated list of names to
% hide.  Thus, \HideEnvirons{ example, proof} would hide all examples
% and proofs.
\newcommand{\HideEnvirons}[1]{\setkeys{hide}{#1}}


% The \ShowEnvirons command works like this: if it's argument is foo,
% it redefines the *hide* family key for foo to do nothing.  Then, it
% issues a \HideEnvirons command containing a list of all the atom
% types.  So, everything is hidden *unless* the hide-family key has
% been redefinied.
  \define@key{show}{scholium}[true]{\define@key{hide}{scholium}{}}
  \define@key{show}{proof}[true]{\define@key{hide}{proof}{}}
  \define@key{show}{lemma}[true]{\define@key{hide}{lemma}{}}
  \define@key{show}{comments}[true]{\define@key{hide}{comments}{}}
  \define@key{show}{cor}[true]{\define@key{hide}{cor}{}}
  \define@key{show}{definition}[true]{\define@key{hide}{definition}{}}
  \define@key{show}{example}[true]{\define@key{hide}{example}{}}
  \define@key{show}{theorem}[true]{\define@key{hide}{theorem}{}}
% This command can be given a comma separated list of names to show,
% and only these will be shown.  Thus,
% \ShowEnvirons{example,definition} will show only examples and definitions.
\newcommand{\ShowEnvirons}[1]
{\setkeys{show}{#1}\HideEnvirons{%
    comments,
    cor,
    definition,
    example,
    proof,
    theorem,
    lemma,
    scholium
  }}
\makeatother

% Comment out the next line to see the full text
 \ShowEnvirons{definition,theorem}


\begin{document}
\tableofcontents

\chapter{General Background}

\section{Notation}

\begin{enumerate}
  \item Notation
  \item That isn't obvious
  \item Goes here
\end{enumerate}

\begin{definition}
  
\end{definition}


\begin{theorem}[First derivative of a Dirichlet Eigenvalue]
  Let $\Omega$ be a bounded open set. We assume that $\lambda_{k}'(\Omega)$ is simple.
  Then, the functions $t \to \lambda_{k}(t), t \to u_{t} \in L^2(\mathbb{R}^{N} )$ are differentiable at $t = 0$ with
  \[
    \lambda_{k}'(0) := - \int_\Omega \! \mathrm{div} (|\nabla u|^2 V) \, \mathrm{d}x 
  .\] 
  If, moreover, $\Omega$ is of class $C^2$ or if $\Omega$ is convex, then
   \[
    \lambda_{k}'(0) := - \int_\Omega \! \left( \pderiv[1]{u}{n}  \right)^2 V.n \, \mathrm{d}\sigma 
  \] 
  and the derivative $u'$ of $u_{t}$ is the solution of

\[ 
  \begin{cases}
    - \Delta u' = \lambda_{k}u' + \lambda_{k}'u & \mathrm{in }  \Omega \\
    \phantom{--}u'  = - \pderiv[1]{u}{n} V.n & \mathrm{on } \partial \Omega \\
    \phantom{-}\int_\Omega \! u u' \, \mathrm{d} \sigma = 0 .
  \end{cases}
\] 
\end{theorem}

\begin{comments}
  Henrot
\end{comments}

\begin{proof}
  TODO
\end{proof}

\begin{comments}
  Things in here aren't printed to pdf
\end{comments}


\end{document}
